Options -Indexes

<FilesMatch ".*\.(log|ini|htaccess)$">
    Deny from all
</FilesMatch>

<IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /trabajoPreguntasYRespuestas/

    # Redirect legacy query style to pretty (controller+method)
    RewriteCond %{THE_REQUEST} \s/index\.php\?controller=([^&]+)&method=([^&\s]+) [NC]
    RewriteRule ^index\.php$ /trabajoPreguntasYRespuestas/%1/%2? [R=301,L]

    # Redirect legacy query style with only controller
    RewriteCond %{THE_REQUEST} \s/index\.php\?controller=([^&\s]+) [NC]
    RewriteRule ^index\.php$ /trabajoPreguntasYRespuestas/%1? [R=301,L]

    # Legacy perfil pÃºblico path (/usuario/publico/username) -> new /perfil/username
    RewriteRule ^usuario/publico/([^/]+)/?$ /trabajoPreguntasYRespuestas/perfil/$1 [R=301,L]

    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d

    # Controller + method + extra tail
    RewriteRule ^([^/]+)/([^/]+)/(.+)$ index.php?controller=$1&method=$2&extra=$3 [QSA,L]
    # Specific named routes
    RewriteRule ^rankings/?$ index.php?controller=RankingController&method=verRankings [QSA,L]
    RewriteRule ^perfil/([^/]+)/?$ index.php?controller=UsuarioController&method=publico&username=$1 [QSA,L]
    RewriteRule ^perfil/?$ index.php?controller=UsuarioController&method=perfil [QSA,L]
    RewriteRule ^modo/?$ index.php?controller=PartidaController&method=mostrarModo [QSA,L]
    RewriteRule ^reglas/?$ index.php?controller=PartidaController&method=mostrarReglas [QSA,L]
    RewriteRule ^ruleta/?$ index.php?controller=PartidaController&method=mostrarRuleta [QSA,L]
    RewriteRule ^login/?$ index.php?controller=login [QSA,L]
    RewriteRule ^login/logout/?$ index.php?controller=login&method=logout [QSA,L]

    # Controller + method (no extra)
    RewriteRule ^([^/]+)/([^/]+)/?$ index.php?controller=$1&method=$2 [QSA,L]
    # Controller only
    RewriteRule ^([^/]+)/?$ index.php?controller=$1 [QSA,L]
</IfModule>

# Security headers
<IfModule mod_headers.c>
    Header always set X-Frame-Options "SAMEORIGIN"
    Header always set X-Content-Type-Options "nosniff"
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
    Header always set Permissions-Policy "geolocation=()"
</IfModule>

